<!DOCTYPE HTML>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,LSQ,Galileo,blog" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Galileo" />
    <link rel="alternate" type="application/rss+xml" title="我的个人博客 &raquo; RSS 2.0" href="/Blog/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="我的个人博客 &raquo; ATOM 1.0" href="/Blog/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/galileo-3f4dcc35c9.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/ExSearch/ExSearch-182e5a8868.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/katex.min.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700&display=swap">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/fe8208f54185c68d53b60fb9f77409e0.json"
        }
    </script>
    
<title>pytorch常见错误总结 - 我的个人博客</title>
<meta name="author" content="刘胜琪" />
<meta name="description" content="总结" />
<meta property="og:title" content="pytorch常见错误总结 - 我的个人博客" />
<meta property="og:description" content="总结" />
<meta property="og:site_name" content="我的个人博客" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/Blog/archives/pytorch%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E6%80%BB%E7%BB%93/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2021-07-29T00:00:00-00.00" />
<meta name="twitter:title" content="pytorch常见错误总结 - 我的个人博客" />
<meta name="twitter:description" content="总结" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css">
<script src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js"></script>
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/logo.png">
<script type='text/javascript' src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/jquery-3.4.1.min.js"></script>
<!-- szgotop -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog/gotop/css/szgotop.css" />
<!-- FancyBox -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/jquery.fancybox.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/jquery.fancybox.min.js"></script>
<script>
$(function() {
   $(".yue figure img").each(function(i) {
      if (!this.parentNode.href) {
         $(this).wrap("<a href='" + this.src + "' data-fancybox='images' data-caption='" + this.alt + "'></a>")
      }
   })
});
</script>
<script type="text/javascript">
$( '[data-fancybox]' ).fancybox({
	protect:true,
	caption : function( instance, item ) {
	return $(this).find('figcaption').html();
	}
});
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d69b9b23082b2143a5bce14c4c459baa";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    </head>
    
    <body>
        
        <div class="container">
            <header id="ga-header">
                <div first>
                    <aside id="ga-brand">
                        <h1 class="brand"><a class="no-style" href="/Blog/">我的个人博客</a></h1>
                        <p>记录生活美好</p>
                    </aside>
                </div>
                <div second id="ga-nav">
                    <nav class="navs">
                        <ul><li><a class="ga-highlight" href="/Blog/" target="_self">首页</a></li><span class="separator">·</span><li><a class="ga-highlight" href="/Blog/archives/" target="_self">归档</a></li><span class="separator">·</span><li><a class="ga-highlight" href="/Blog/about/" target="_self">关于</a></li><span class="separator">·</span><li><a href="#" target="_self" class="search-form-input ga-highlight">搜索</a></li></ul>
                    </nav>
                </div>
            </header>
            <div class="wrapper">
                
<main>    
    <section class="ga-section ga-content">
        <article class="yue">
            <h1 class="ga-post_title">pytorch常见错误总结</h1>
            <span class="ga-post_meta ga-mono">
                <span>刘胜琪</span>
                <time>
                    2021-07-29
                </time>
                
                in <a no-style class="category" href="/Blog/category/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/">
                    默认分类
                </a>
                
                
            </span>
            <div class="ga-content_body">
                <p><strong>PyTorch常见报错汇总</strong></p><ol>
<li></li>
</ol>
<p>报错： ValueError: num_samples should be a positive integer value, but got num_samples=0</p><p>可能的原因：传入的Dataset中的len(self.data_info)==0，即传入该dataloader的dataset里没有数据</p><p>解决方法：</p><ol>
<li><p>检查dataset中的路径，路径不对，读取不到数据。</p></li>
<li><p>检查Dataset的<strong>len</strong>()函数为何<strong>输出为零</strong></p></li>
</ol>
<p>2</p><p>报错：TypeError: pic should be PIL Image or ndarray. Got &lt;class 'torch.Tensor'&gt;</p><p>可能的原因：当前操作需要PIL Image或ndarray数据类型，但传入了Tensor</p><p>解决方法：</p><ol>
<li><p>检查transform中是否存在<strong>两次ToTensor()方法</strong></p></li>
<li><p>检查transform中每一个操作的数据类型变化</p></li>
</ol>
<p>3</p><p>报错：RuntimeError: invalid argument 0: Sizes of tensors must match except in dimension 0. Got 93 and 89 in dimension 1 at /Users/soumith/code/builder/wheel/pytorch-src/aten/src/TH/generic/THTensorMath.cpp:3616</p><p>可能的原因：dataloader的__getitem__函数中，返回的图片形状不一致，导致无法stack</p><p>解决方法：检查__getitem__函数中的操作</p><p>4</p><p>报错：</p><p>conv: RuntimeError: Given groups=1, weight of size 6 1 5 5, expected input[16, 3, 32, 32] to have 1 channels, but got 3 channels instead</p><p>linear: RuntimeError: size mismatch, m1: [16 x 576], m2: [400 x 120] at ../aten/src/TH/generic/THTensorMath.cpp:752</p><p>可能的原因：网络层输入数据与网络的参数不匹配</p><p>解决方法：</p><ol>
<li><p>检查对应网络层前后定义是否有误</p></li>
<li><p>检查输入数据shape</p></li>
</ol>
<p>5</p><p>报错：AttributeError: 'DataParallel' object has no attribute 'linear'</p><p>可能的原因：并行运算时，模型被dataparallel包装，所有module都增加一个属性 module. 因此需要通过 net.module.linear调用</p><p>解决方法：</p><ol>
<li>网络层前加入module.</li>
</ol>
<p>6</p><p>报错:</p><p>RuntimeError: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.</p><p>可能的原因：gpu训练的模型保存后，在无gpu设备上无法直接加载，或者内存不够了</p><p>解决方法：</p><ol>
<li>需要设置map_location=&quot;cpu&quot;</li>
</ol>
<p>7</p><p>报错：</p><p>AttributeError: Can't get attribute 'FooNet2' on &lt;module '<strong>main</strong>' from '</p><p>可能的原因：保存的网络模型在当前python脚本中没有定义</p><p>解决方法：</p><ol>
<li>提前定义该类</li>
</ol>
<p>8</p><p>报错：</p><p>RuntimeError: Assertion `cur_target &gt;= 0 &amp;&amp; cur_target &lt; n_classes' failed. at ../aten/src/THNN/generic/ClassNLLCriterion.c:94</p><p>可能的原因：</p><ol>
<li>标签数大于等于类别数量，即不满足 cur_target &lt; n_classes，通常是因为<strong>标签从1开始而不是从0开始</strong></li>
</ol>
<p>解决方法：</p><ol>
<li>修改label，从0开始，例如：10分类的标签取值应该是0-9</li>
</ol>
<p>9</p><p>报错：</p><p>RuntimeError: expected device cuda:0 and dtype Long but got device cpu and dtype Long</p><p>Expected object of backend CPU but got backend CUDA for argument #2 'weight'</p><p>可能的原因：需计算的两个数据不在同一个设备上</p><p>解决方法：采用to函数将数据迁移到同一个设备上</p><p>10</p><p>报错：</p><p>RuntimeError: DataLoader worker (pid 27) is killed by signal: Killed. Details are lost due to multiprocessing. Rerunning with num_workers=0 may give better error trace.</p><p>可能原因：内存不够（不是gpu显存，是内存）</p><p>解决方法：申请更大内存</p><p>11</p><p>报错：</p><figure style="flex: 514.2857142857143" ><img width="720" height="70" src="https://pic2.zhimg.com/80/v2-92824691477c695c9e7c5a6e6e6263fd_720w.png" /><figcaption>img</figcaption></figure><p>RuntimeError: reduce failed to synchronize: device-side assert triggered</p><p>可能的原因：采用<strong>BCE损失函数的时候，input必须是0-1之间</strong>，由于模型最后没有加sigmoid激活函数，导致的。</p><p>解决方法：让模型输出的值域在[0, 1]</p><p>12</p><p>报错：RuntimeError: unexpected EOF. The file might be corrupted.</p><p>torch.load加载模型过程报错，因为模型传输过程中有问题，重新传一遍模型即可</p><p>13</p><p>报错：UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte</p><p>可能的原因：<strong>python2保存，python3加载，会报错</strong></p><p>解决方法：把<strong>encoding改为encoding='iso-8859-1'</strong></p><p>check_p = torch.load(path, map_location=&quot;cpu&quot;, encoding='iso-8859-1')</p><p>14</p><p>报错：RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same</p><p>问题原因：数据张量已经转换到GPU上，但模型参数还在cpu上，造成计算不匹配问题。</p><p>解决方法：通过添加model.cuda()将模型转移到GPU上以解决这个问题。或者通过添加model.to(cuda)解决问题</p><ol start="15">
<li></li>
</ol>
<p>报错：ValueError: num_samples should be a positive integer value, but got num_samples=0</p><p>问题原因：高版本pytorch对于tensor.data[0]会报错，统一修改成tensor.item()</p><p>实验代码demo</p><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> 
<span class="n">a</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
<p><strong>print(a.item()) 运行该行代码会报错</strong></p><figure style="flex: 120.91503267973856" ><img width="370" height="153" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/2b1c7d53e81bc775f36bc651cb2d3632.png" /><figcaption>在这里插入图片描述</figcaption></figure>
            </div>
        </article>
        <div id="ga-tags">
    
    <span class="ga-tag">
        <a class="ga-highlight" href="/Blog/tag/-/">#-</a>
    </span>
    
    <span class="ga-tag">
        <a class="ga-highlight" href="/Blog/tag/%E4%BB%A3/">#代</a>
    </span>
    
    <span class="ga-tag">
        <a class="ga-highlight" href="/Blog/tag/%E7%A0%81/">#码</a>
    </span>
    
    <span class="ga-tag">
        <a class="ga-highlight" href="/Blog/tag/%E9%94%99/">#错</a>
    </span>
    
    <span class="ga-tag">
        <a class="ga-highlight" href="/Blog/tag/%E8%AF%AF/">#误</a>
    </span>
    
</div>
    </section>
    
<section id="ga-content_pager">

    <div class="next">
        <a class="ga-highlight" href="/Blog/archives/docker%E4%BD%BF%E7%94%A8/">docker使用</a>
        <p class="yue">docker使用</p>
    </div>


    <div class="prev">
        <a class="ga-highlight" href="/Blog/archives/HMDB51%E5%A4%84%E7%90%86/">HMDB数据集</a>
        <p class="yue">HMDB51数据集</p>
    </div>

</section>


    

</main>

                <footer class="ga-mono" id="ga-footer">
                    <section>
                        <span id="ga-uptime"></span>
                        <span class="brand"><a no-style href="https://github.com/Arley517693777" target="_blank">我的个人博客</a></span>
                    </section>
                    <section>
                        <p class="copyright">
                            <span>Copyright © 2021 LSQ</span>
                            <span>Powered by <a no-style href="https://github.com/AlanDecode/Maverick" target="_blank">Maverick</a></span>
                        </p>
                        <div class="copyright">
                            <span class="footer-addon">
                                
                            </span>
                            <nav class="social-links">
                                <ul><li><a class="no-style" title="Twitter" href="https://twitter.com/lsq15" target="_blank"><i class="gi gi-twitter"></i>Twitter</a></li><span class="separator">·</span><li><a class="no-style" title="GitHub" href="https://github.com/LSQsjtu" target="_blank"><i class="gi gi-github"></i>GitHub</a></li></ul>
                            </nav>
                        </div>
                    </section>
                    <script>
                        var site_build_date = "2021-05-04T22:46+08:00"
                    </script>
                    <script src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/galileo-dc4baa7cf4.js"></script>
                </footer>
            </div>
        </div>
    </div>

    <!--katex-->
    <script defer src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/katex.min.js"></script>
    <script>
    mathOpts = {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\[", right: "\\]", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\(", right: "\\)", display: false}
        ]
    };
    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    <script src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog/gotop/js/szgotop.js"></script>
<div class="back-to-top cd-top faa-float animated cd-is-visible" style="top: -999px;"></div>

    </body>
</html>