<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN"><id>/Blog/</id><title>我的个人博客</title><updated>2021-10-02T13:49:57.461445+08:06</updated><author><name>LSQ</name><email>1959376918@qq.com</email></author><link href="/Blog/" rel="alternate"/><generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator><logo>https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/f-logo.png</logo><subtitle>记录生活美好</subtitle><entry><id>/Blog/archives/Disneyland/</id><title>迪士尼乐园游记</title><updated>2021-10-02T13:49:57.461901+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;迪士尼乐园&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		第一次去迪士尼乐园，本以为就是一个童话主题的美好乐园，但它更多强调的是所有的童话元素呈现出来，有冒险，有休闲，有心里美好的童话。&lt;/p&gt;&lt;p&gt;​		所有的项目都大致转了一遍。&lt;/p&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;创极速光轮&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		以飞车卡紧身体，是一个紧张刺激的过山车项目，有绚丽的色彩变换和特效，急转弯的失重，是第一个值得体验的美好项目。旁边的雪佛兰数字挑战只是一个汽车体验项目，并没有吸引人的地方。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4160" height="3120" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/485c7d3279dc3e4c913c135bd3777e60.jpg" /&gt;&lt;figcaption&gt;创极速光轮&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;​			从这里进入，绕过长长的等候道路，进入蓝色炫光的奇妙世界。&lt;/p&gt;&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/c20da7b2024f615d629126dd60103dfd.jpg" /&gt;&lt;figcaption&gt;等候中&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;​			离开后从外面看去，弯弯曲曲的轨道是快速通过时尖叫的回忆&lt;/p&gt;&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4160" height="3120" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/eab674f9b7cbb31142eff9fcd62e14c9.jpg" /&gt;&lt;figcaption&gt;外观&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="2"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;喷气背包飞行器&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		绑在座位上，绕着柱子快速的转动，有清风拂面的微凉爽意。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 37.5" &gt;&lt;img width="3120" height="4160" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/1a0fd7b33916115cad23cb30e7ac8972.jpg" /&gt;&lt;figcaption&gt;喷气背包飞行器&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="3"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;太空幸会史迪奇&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		和史迪奇的互动，猜测有人工在后面，并不是太适合青少年的游乐。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;巴斯光年星际营救&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		绕过一个隧道，在可旋转的车上对准靶子射击&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 37.5" &gt;&lt;img width="3000" height="4000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/3e2d88e18cc109344b90fc411e51226f.jpg" /&gt;&lt;figcaption&gt;射击&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="5"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;抱抱龙冲天赛车&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		一个看似童真，休闲的项目，但突然的失重让人难以缓过神来，强烈的眩晕和腹痛感&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/14c0a494ca19c940ca7554aefcacc672.jpg" /&gt;&lt;figcaption&gt;nightmare&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="6"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;小飞侠天空奇遇&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		乘坐过山车，沿途欣赏场景来往，以主题为主，并不是特别的震撼&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;晶彩奇航&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		乘船绕着湖道前行，一路上有许许多多的场景&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/385910e25ca827ec20071b21fe83d3c7.jpg" /&gt;&lt;figcaption&gt;公主和野兽&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="8"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;探险家独木舟&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		自己用桨划船，容易撞到旁边的石头，需要手动控制，慢慢的在湖上荡漾&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 37.5" &gt;&lt;img width="3000" height="4000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/919e54641e0453098f72dfa18ce52bb6.jpg" /&gt;&lt;figcaption&gt;划船中的景色&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="9"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;加勒比海盗——沉落宝藏之战&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		爆炸的裸眼3D特效，溅水而过的酣畅淋漓，偶尔有一下倒转的下落&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/9db6849ea5e63cde548df8a2ce78851c.jpg" /&gt;&lt;figcaption&gt;加勒比海盗船&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="10"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;船奇戏水滩&lt;/strong&gt;和&lt;strong&gt;探秘海妖复仇号&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		两个较为简单的了解海盗船，体验打水仗的项目，可以慢慢走，慢慢看&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 37.5" &gt;&lt;img width="3120" height="4160" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/912e33107c2cb94a11ff8d496fe92e2b.jpg" /&gt;&lt;figcaption&gt;景观台&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="11"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;雷鸣山漂流&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		提前准备好雨衣，门前商店扫码购买雨衣，较为晕眩刺激的，一直在水面上打转转，有短暂的失重下落，溅起浪花，靠进去地方多少会沾湿一点&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;独步行道&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		通过吊索勾着，缓慢通过狭窄的绳桥，瀑布悬崖处较滑，不易通过，小心一点，注意崖边抓手点，另一边山谷没有尝试&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 37.5" &gt;&lt;img width="3000" height="4000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/e78204201f5b78dbd26f17383b464d5a.jpg" /&gt;&lt;figcaption&gt;独步行道&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="13"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;飞跃地平线&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		环球场景的裸眼3D呈现，有短暂的飞行感觉，特别真实的场景画面，甚至有香水喷洒&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;花车巡游&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		沿街的舞蹈，挤满路边的游客，激动明快的音乐节奏，让人忍不住起舞&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="3264" height="2448" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/8049c27244b5ed4b52023071b60a41eb.jpg" /&gt;&lt;figcaption&gt;花车巡游&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="15"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;七个小矮人矿山车&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		普通的过山车项目，没有什么特别夸张的急速和失重&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;爱丽丝梦游仙境迷宫&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		红皇后拍照打卡地点，充满绿植的一间迷宫&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;旋转蜂蜜罐&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		在一个杯子中，建议两个人乘坐，缓慢的转圈圈&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4160" height="3120" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/ca49bb5b879de9540ea23b448458eb40.jpg" /&gt;&lt;figcaption&gt;旋转蜂蜜罐&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="18"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;小熊维尼历险记&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		乘坐小车，经过房间，充满小熊维尼主题的器材&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;漫威英雄总部&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		一个以漫威为主题的展览馆&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;旋转木马&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		晚上非常适合拍照的美好景点，体验儿童的乐趣，少女心爆棚的地方&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/4b0102a57aca2914e65cd8c844388b1f.jpg" /&gt;&lt;figcaption&gt;旋转木马&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start="21"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;烟花秀和灯光秀&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		建议中间的位置，提前占好位置，非常美丽的烟花秀&lt;/p&gt;&lt;p&gt;​		下次出行，零食的携带和提前订好晚餐，不用携带文具盒和本子，休息好，不用太赶，体验真正的少女心的生活。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;[x] 图片补全&lt;/p&gt;&lt;p&gt;​	最后永远在心中的迪士尼城堡&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure style="flex: 66.66666666666667" &gt;&lt;img width="4000" height="3000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/a3bf88ea1891ece0f42b79f6396f1173.jpg" /&gt;&lt;figcaption&gt;迪士尼城堡&lt;/figcaption&gt;&lt;/figure&gt;</content><link href="/Blog/archives/Disneyland/" rel="alternate"/><published>2021-09-08T00:00:00+08:06</published></entry><entry><id>/Blog/archives/3DMM/</id><title>3DMM的3D人脸重建</title><updated>2021-10-02T13:49:57.461868+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;3DMM的3D人脸重建&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		3D建模主要包括3种，软件建模，仪器采集（不用通过人工建模雕刻），基于图像的建模，通过2维图像进行3D建模&lt;/p&gt;&lt;p&gt;​		人脸图像的3D重建包括立体匹配，Structure From Motion(简称SfM)，Shape from Shading(简称sfs)，三维可变形人脸模型(3DMM)，3D Morphable models(简称3DMM)&lt;/p&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;​	&lt;strong&gt;基本思想&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​	用一个通用的三维人脸模型和固定的点数来表示人脸，&lt;strong&gt;它的核心思想就是人脸可以在三维空间中进行一一匹配，并且可以由其他许多幅人脸正交基加权线性相加而来&lt;/strong&gt;。所以先确定人脸的基，在进行线性组合即可。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 305.08474576271186" &gt;&lt;img width="720" height="118" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/2f35040d33004b88392c909252dd46aa.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;​		使用PCA进行降维分解，形成正交的基向量。&lt;/p&gt;&lt;p&gt;​			(1) 首先计算形状和纹理向量的平均值。&lt;/p&gt;&lt;p&gt;​			(2) 中心化人脸数据。&lt;/p&gt;&lt;p&gt;​			(3) 分别计算协方差矩阵。&lt;/p&gt;&lt;p&gt;​			(4) 求得形状和纹理协方差矩阵的特征值α，β和特征向量si，ti。&lt;/p&gt;&lt;p&gt;​		上式可以转换为下式&lt;/p&gt;&lt;figure style="flex: 265.4639175257732" &gt;&lt;img width="515" height="97" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/823224055c1775fff3a5a3905533cdc8.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;​		其中第一项是形状和纹理的平均值，而si，ti则都是Si，Ti减去各自平均值后的协方差矩阵的特征向量，它们对应的特征值按照大小进行降序排列。&lt;/p&gt;&lt;p&gt;​		等式右边仍然是m项，但是累加项降了一维，减少了一项。si，ti都是线性无关的，取其前几个分量可以对原始样本做很好的近似，因此可以大大减少需要估计的参数数目，并不失精度。&lt;/p&gt;&lt;figure style="flex: 38.96103896103896" &gt;&lt;img width="720" height="924" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/d77e32bf93d335587c2710235fd8c1ba.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;​		(a) 初始化一个3维的模型，需要初始化内部参数α，β，以及外部渲染参数，包括相机的位置，图像平面的旋转角度，直射光和环境光的各个分量，图像对比度等共20多维，有了这些参数之后就可以唯一确定一个3D模型到2D图像的投影。&lt;/p&gt;&lt;p&gt;​		(b) 在初始参数的控制下，经过3D至2D的投影，即可由一个3D模型得到2维图像，然后计算与输入图像的误差。再以误差反向传播调整相关系数，调整3D模型，不断进行迭代。每次参与计算的是一个三角晶格，如果人脸被遮挡，则该部分不参与损失计算。&lt;/p&gt;&lt;p&gt;​		(c) 具体迭代时采用由粗到精的方式，初始的时候使用低分辨率的图像，只优化第一个主成分的系数，后面再逐步增加主成分。在后续一些迭代步骤中固定外部参数，对人脸的各个部位分别优化。&lt;/p&gt;&lt;p&gt;​		对于只需要获取人脸形状模型的应用来说，很多方法都会使用2D人脸关键点来估计出形状系数，具有更小的计算量，迭代也更加简单，另外还会增加一个正则项，所以一个典型的优化目标是如下：&lt;/p&gt;&lt;figure style="flex: 318.5840707964602" &gt;&lt;img width="720" height="113" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/6eab0278a49e70d7ae5fe7f31903330e.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;​		该问题是病态问题。&lt;strong&gt;病态问题（ill-conditioned problem）&lt;/strong&gt;是指输出结果相对于输入非常敏感的问题，输入数据中哪怕是极少（或者极微妙）的噪声也会导致输出的较大改变（该术语并没有严格的官方定义）。
 	相反的，对于输入不敏感的问题，我们就称为&lt;strong&gt;良态问题（well-conditioned problem）&lt;/strong&gt;。&lt;/p&gt;&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;loss的设计&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;​		优化目标的设计。因为重建的结果是一个三维模型，所以损失函数是在三维的空间中计算，如果使用标准的欧拉损失函数来最小化距离，会使得到的人脸模型太泛化，趋于平均脸。对此作者们提出了一个非对称欧拉损失，使模型学习到更多的细节特征，使三维人脸模型具有更多的区别性，公式如下：&lt;/p&gt;&lt;figure style="flex: 128.1138790035587" &gt;&lt;img width="720" height="281" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/bdeeb8cb93ef81a91e080a0a899d3e21.jpg" /&gt;&lt;figcaption&gt;img&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;​		γ是标签，γp是预测值，通过两个权重λ1和λ2对损失进行控制，作者设定λ2权重更大，所以是期望γp能够更大一些，从而提供更多的细节。&lt;/p&gt;&lt;ol start="3"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;难点和展望&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;​		从1999年被提出，至今3DMM模型已经有超过20年的历史，技术已经发展到从早期基于传统的优化方法到如今基于深度学习模型的系数回归，不过当前的3DMM模型还面临着许多的挑战。&lt;/p&gt;&lt;p&gt;​	(1) 当前的模型基本上都受限于人脸，没有眼睛，嘴唇以及头发信息，然而这些信息对于很多的应用却非常有效。&lt;/p&gt;&lt;p&gt;​	(2) 3DMM模型参数空间是一个比较低维的参数空间，并且纹理模型过于简单。基于3DMM模型的方法面临的最大问题就是结果过于平均，难以重建人脸皱纹等细节特征，并且无法恢复遮挡。对此有的方法通过增加局部模型[13]进行了改进，而最新的生成对抗网络技术[14]也开始被用于纹理建模。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 240.0" &gt;&lt;img width="720" height="150" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/8752c24d2b746017d31a57327d3145ca.jpg" /&gt;&lt;figcaption&gt;img&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;​		(3) 遮挡脸的信息恢复。二维的人脸信息一旦被遮挡，也难以被精确地重建，除了利用人脸的对称先验信息进行补全外，有的方法借鉴了检索匹配[15]的思路，即建立一个无遮挡的数据集，将重建的模型进行姿态匹配和人脸识别相似度匹配，然后经过2D对齐，使用基于梯度的方法来进行纹理迁移，也有的方法使用GAN来进行遮挡信息恢复[16]。&lt;/p&gt;&lt;figure style="flex: 162.89592760180994" &gt;&lt;img width="720" height="221" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/b23f35a0f2b6c3c3001abeb95d02cfc9.jpg" /&gt;&lt;figcaption&gt;img&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;​		(3) 当前3DMM模型中主要使用PCA来提取主成分信息，但是这不符合我们通常对人脸的描述，因此这==并非是一个最合适的特征空间。==&lt;em&gt;什么是适合的特征空间呢？&lt;/em&gt;&lt;/p&gt;&lt;p&gt;​		(4) 当前存在着各种各样的3DMM模型的变种，但是没有一个模型能够在各种场景下取得最优的效果。&lt;/p&gt;&lt;p&gt;​		另一方面，3DMM模型也与许多新的技术开始结合，比如与生成对抗网络模型一起进行人脸的数据增强[17]，姿态编辑[17]，人脸的特征恢复[18]，对于提升人脸识别模型在具有挑战性的大姿态以及遮挡场景下的性能中具有非常重要的意义。&lt;/p&gt;&lt;figure style="flex: 54.794520547945204" &gt;&lt;img width="720" height="657" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/af58f6fc7287dca048dbe7be9c38e9bd.jpg" /&gt;&lt;/figure&gt;&lt;figure style="flex: 152.54237288135593" &gt;&lt;img width="720" height="236" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/71b88fe64ba1adcdd31f2326a698a420.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;使用点投影到2D平面，看点与点之间的偏差，或者利用3D的工具可视化，观看效果&lt;/p&gt;</content><link href="/Blog/archives/3DMM/" rel="alternate"/><published>2021-09-10T00:00:00+08:06</published></entry><entry><id>/Blog/archives/RAAR3DNet/</id><title>RAAR3DNet理解</title><updated>2021-10-02T13:49:57.461836+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;Dynamic- Static Attention (DSA)生成heatmap，时序和空间上的attention。代码中为MaxPool3d_5a_2x2类&lt;/p&gt;&lt;p&gt;主要region attention&lt;/p&gt;&lt;p&gt;&lt;strong&gt;a fast approximate rank pooling algorithm&lt;/strong&gt;去学习图片累积的时间信息&lt;/p&gt;&lt;p&gt;DSA consists of the SAtt and DAtt sub-modules. SAtt highlights the hands/arms features via an online learnable Gaussian skeleton heatmap while DAtt captures the gesture motions via the proposed fast approximate rank pooling al- gorithm&lt;/p&gt;&lt;p&gt;将I3D中前两个inception module改为cell1，中间五个inception module改为cell2，最后两个改为cell3&lt;/p&gt;&lt;p&gt;&lt;em&gt;a fast approximate rank pooling algorithm&lt;/em&gt;（MaxPool3dSamePadding，3D池化）&lt;/p&gt;&lt;img src="RAAR3DNet.assets/image-20210621165020409.png" alt="image-20210621165020409" style="zoom:50%;" /&gt;
&lt;p&gt;rank pooling计算后面帧与前面帧的差距（feature）&lt;/p&gt;&lt;figure style="flex: 196.6887417218543" &gt;&lt;img width="1188" height="302" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/fa203b61bddf5cd6fb85075be68881a9.png" /&gt;&lt;figcaption&gt;image-20210624161336372&lt;/figcaption&gt;&lt;/figure&gt;&lt;img src="RAAR3DNet.assets/image-20210621165137037.png" alt="image-20210621165137037" style="zoom:50%;" /&gt;
&lt;p&gt;$T=m-n+1$&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tensor_merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arr&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;arr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;arr&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;arrrp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tensor_arr_rp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tensor_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;#DI且m-n=slef._w,tensor_split(x)为每一帧的f&lt;/span&gt;
&lt;span class="n"&gt;arrrp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;relu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bnrp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tensor_merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arrrp&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; 
&lt;span class="n"&gt;arrrp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cuda&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tensor_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arrrp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;tensor_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))]&lt;/span&gt; &lt;span class="c1"&gt;#加1防止0 attention map，逐元素相乘&lt;/span&gt;
&lt;span class="n"&gt;arrrp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;oneconv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tensor_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;arrrp&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;&lt;span class="c1"&gt;#attention和feature卷积 时间attention&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;  &lt;span class="c1"&gt;#返回一个或多个迭代器;取最短的一个&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;:gmap:&lt;/strong&gt; gaussian heat map&lt;/p&gt;&lt;p&gt;&lt;strong&gt;HeatmapNet&lt;/strong&gt; 产生热图&lt;/p&gt;&lt;p&gt;&lt;code&gt;# logits is batch X time X classes, which is what we want to work with&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;return logits.squeeze(), gmap3, (f1, f2, f3,f4, f5)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;返回置信度，最终heat map，中间特征&lt;/p&gt;&lt;img src="RAAR3DNet.assets/image-20210621212820360.png" alt="image-20210621212820360" style="zoom:50%;" /&gt;
&lt;p&gt;heatmap获得&lt;/p&gt;&lt;img src="RAAR3DNet.assets/image-20210621212901148.png" alt="image-20210621212901148" style="zoom: 67%;" /&gt;
&lt;p&gt;guidance map做平均，通过均方差MSEloss学习heatmap net&lt;/p&gt;&lt;figure style="flex: 254.82456140350877" &gt;&lt;img width="581" height="114" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/4ccda829c5669a7b934424708ac388c7.png" /&gt;&lt;figcaption&gt;image-20210624113034031&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;训练使用的数据集不一样？&lt;/p&gt;&lt;figure style="flex: 129.79041916167665" &gt;&lt;img width="867" height="334" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/3428e5c200f6360538d1d31deda9bf9b.png" /&gt;&lt;figcaption&gt;image-20210624115213094&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;baseline中没有训练heatmap net&lt;/p&gt;</content><link href="/Blog/archives/RAAR3DNet/" rel="alternate"/><published>2021-09-12T00:00:00+08:06</published></entry><entry><id>/Blog/archives/face%20tracking/</id><title>face tracking</title><updated>2021-10-02T13:49:57.461799+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;face tracking&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;模型生成的tensor要去除求导属性，.detach()之后再用于可视化&lt;/p&gt;&lt;p&gt;2D动漫脸的关键点手工标记，不用标记嘴巴和鼻子，用3D模型的2D投影去fitting，刚好取脸颊和眼睛的点去fitting&lt;/p&gt;&lt;p&gt;设计两个网络，前面一个叫encoder，生成latent code再进入decoder，生成output&lt;/p&gt;&lt;p&gt;开会讨论时接触了许多新的一些知识，但都没有自己插手的地方，自己目前还是没有能力独立承担工程中的任何任务，讨论创新点时更多的是以写论文讲故事的方面去讨论，工程能力上的实现多半是因为网络模型本身结构的能力和泛化训练的效果有关，无法做到突破性进展，更多的是工程上的效果。&lt;/p&gt;&lt;p&gt;从landmark的标记数据集，训练方法，学习id、exp和最后的texture，保存文件的格式和方法，最后便是渲染的一些基本知识，二次元作画的风格。&lt;/p&gt;&lt;p&gt;texture指的是纹理（颜色形状之类的），材质指的是反射吸收光线的强弱之类的&lt;/p&gt;</content><link href="/Blog/archives/face%20tracking/" rel="alternate"/><published>2021-09-13T00:00:00+08:06</published></entry><entry><id>/Blog/archives/3Dtracking/</id><title>Centerpoint based 3D Tracking</title><updated>2021-10-02T13:49:57.461769+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;Centerpoint&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;voxel网络结构和输出tensor形状&lt;/p&gt;&lt;p&gt;reader：type=&amp;quot;VoxelFeatureExtractorV3&amp;quot;,取平均&lt;/p&gt;&lt;p&gt;输入torch.Size([体素数, 10, 5])&amp;quot;features&amp;quot;， torch.Size([体素数])&amp;quot;num_voxels&amp;quot;，输出torch.Size([体素数, 5])input_features&lt;/p&gt;&lt;p&gt;backbone：type=&amp;quot;SpMiddleResNetFHD&amp;quot;&lt;/p&gt;&lt;p&gt;输入torch.Size([体素数, 5])，torch.Size([体素数, 4]) coordinate[0,位置坐标]，batch_size:1，data[input_shape]：[1440 1440   40]，输出x.shape：torch.Size([1, 256, 180, 180])，{'conv1': &amp;lt;spconv.SparseConvTensor object at 0x7f8f56e68ef0&amp;gt;, 'conv2': &amp;lt;spconv.SparseConvTensor object at 0x7f8f56e68b70&amp;gt;, 'conv3': &amp;lt;spconv.SparseConvTensor object at 0x7f8f56e68f98&amp;gt;, 'conv4': &amp;lt;spconv.SparseConvTensor object at 0x7f8f56e68d30&amp;gt;} voxel_feature&lt;/p&gt;&lt;p&gt;neck：type=&amp;quot;RPN&amp;quot;&lt;/p&gt;&lt;p&gt;输入x.shape：torch.Size([1, 256, 180, 180])，输出x.shape：torch.Size([1, 512, 180, 180])&lt;/p&gt;&lt;p&gt;bbox_head：type=&amp;quot;CenterHead&amp;quot;&lt;/p&gt;&lt;p&gt;输入x.shape：torch.Size([1, 512, 180, 180])，输出list为&lt;/p&gt;&lt;p&gt;&lt;strong&gt;[&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 1, 180, 180])},&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 2, 180, 180])},&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 2, 180, 180])},&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 1, 180, 180])},&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 2, 180, 180])},&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;{'reg': tensor([1, 2, 180, 180]), 'height': tensor([1, 1, 180, 180]), 'dim': tensor([1, 3, 180, 180]), 'rot': tensor([1, 2, 180, 180]), 'vel': tensor([1, 2, 180, 180]), 'hm': tensor([1, 2, 180, 180])}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;]&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;output的结果&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;box&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="err"&gt;d_lidar&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;tens&lt;/span&gt;&lt;span class="err"&gt;or(&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt; &lt;span class="mf"&gt;9.5765e-01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-8.1574e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-1.1584e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;2.3936e-01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;1.7465e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-3.0140e+00&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="mf"&gt;1.0656e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;2.0182e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;2.1907e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.6337e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;1.6447e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-2.3173e+00&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="mf"&gt;3.9706e-01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-3.0798e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-1.4518e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-1.4510e-01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;4.8273e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-3.1372e+00&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="mf"&gt;2.1409e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;2.1294e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-6.0946e-02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;7.9199e-09&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;9.7809e-10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-2.8571e+00&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;-1.5230e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.1139e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-6.7530e-01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;4.3063e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;1.9419e-04&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-3.6318e-01&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;-1.5802e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-6.9950e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;1.3413e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="err"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-4.8845e-04&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="mf"&gt;1.7079e-03&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;-3.0042e+00&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="err"&gt;device=&amp;#39;cuda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;scores&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;tens&lt;/span&gt;&lt;span class="err"&gt;or(&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.8431&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.6624&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5860&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5637&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3287&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1784&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1722&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1657&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1492&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3096&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2991&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2722&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2451&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2037&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1750&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1609&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1528&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1380&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1141&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1139&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1119&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1094&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1057&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1026&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1006&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2855&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1238&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1084&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1011&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3027&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2017&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1995&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1879&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1484&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1203&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1194&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1112&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1097&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1060&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1005&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3652&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.3497&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2844&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2724&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2464&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2014&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1862&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1774&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1621&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1597&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1568&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1543&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1427&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1394&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1370&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1329&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1289&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1259&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1242&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1232&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1224&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1131&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1129&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1082&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1037&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1033&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1011&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1008&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1002&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3860&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3815&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2732&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2582&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2510&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2181&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.2094&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2045&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1980&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1971&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1832&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1817&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1743&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1688&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1662&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1655&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1621&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1613&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1432&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1402&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1349&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1346&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1345&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1308&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1301&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1275&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1198&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1164&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1160&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1044&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1038&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1027&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mf"&gt;0.1027&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1007&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1002&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="err"&gt;device=&amp;#39;cuda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;label_preds&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;tens&lt;/span&gt;&lt;span class="err"&gt;or(&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="err"&gt;device=&amp;#39;cuda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;me&lt;/span&gt;&lt;span class="kc"&gt;ta&lt;/span&gt;&lt;span class="err"&gt;da&lt;/span&gt;&lt;span class="kc"&gt;ta&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;image_pre&lt;/span&gt;&lt;span class="kc"&gt;f&lt;/span&gt;&lt;span class="err"&gt;ix&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="err"&gt;PosixPa&lt;/span&gt;&lt;span class="kc"&gt;t&lt;/span&gt;&lt;span class="err"&gt;h(&amp;#39;da&lt;/span&gt;&lt;span class="kc"&gt;ta&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="kc"&gt;nu&lt;/span&gt;&lt;span class="err"&gt;Sce&lt;/span&gt;&lt;span class="kc"&gt;nes&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="kc"&gt;nu&lt;/span&gt;&lt;span class="err"&gt;m_poi&lt;/span&gt;&lt;span class="kc"&gt;nt&lt;/span&gt;&lt;span class="err"&gt;_&lt;/span&gt;&lt;span class="kc"&gt;features&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="kc"&gt;t&lt;/span&gt;&lt;span class="err"&gt;oke&lt;/span&gt;&lt;span class="kc"&gt;n&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;b&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;b&lt;/span&gt;&lt;span class="mi"&gt;81&lt;/span&gt;&lt;span class="err"&gt;c&lt;/span&gt;&lt;span class="kc"&gt;f&lt;/span&gt;&lt;span class="err"&gt;d&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="err"&gt;d&lt;/span&gt;&lt;span class="mi"&gt;734881&lt;/span&gt;&lt;span class="err"&gt;ad&lt;/span&gt;&lt;span class="mf"&gt;386e5&lt;/span&gt;&lt;span class="err"&gt;c&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="err"&gt;b&lt;/span&gt;&lt;span class="mf"&gt;00e&lt;/span&gt;&lt;span class="err"&gt;d&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}}]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;tasks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;car&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;truck&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;construction_vehicle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bus&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;trailer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;barrier&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;motorcycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;bicycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pedestrian&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;traffic_cone&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;六种种类一个batch_size&lt;/p&gt;&lt;p&gt;猜想输出为regression，height-above-ground，dimension，rotation，velocity，heat-map&lt;/p&gt;&lt;p&gt;H,W为180&lt;/p&gt;&lt;p&gt;batch_box_preds：tensor[(1, 32400, 9)]，32400=180*180，9=xs(1)+ys(1)+batch_hei(1)+batch_dim(3)+batch_vel(2)+batch_rot(1)&lt;/p&gt;&lt;p&gt;dataloader处理后的数据为{'metadata': {'image_prefix': PosixPath('data/nuScenes'), 'num_point_features': 5, 'token': 'e411f0ab3a0243f1bea593bed340894f'}, 'points':（点数，5）, 'voxels'（体素数，10，5）:'shape': array([1440, 1440,   40]), 'num_points': 表示每个体素中的点云数量), 'num_voxels': 体素数), 'coordinates': (体素数，3)array([[ 16, 717, 682],
       [ 16, 717, 680],
       [ 16, 717, 678],
       ...,
       [ 28, 701, 636],
       [ 28, 701, 641],
       [ 28, 702, 638]], dtype=int32)}&lt;/p&gt;&lt;p&gt;每个体素最多10个点&lt;/p&gt;&lt;p&gt;NuScenes数据集中lidar文件名用时间戳区分文件&lt;/p&gt;&lt;figure style="flex: 152.0700636942675" &gt;&lt;img width="955" height="314" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/87d8a3786a8d11c4cb570194d941f95d.png" /&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;汽车编号-时间-相机位置-时间戳.jpg
汽车编号-时间-雷达位置-时间戳.pcd.bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;'num_point_features'：前4个是点feature，一般是xyz和反射率，后一个是时间信息&lt;/p&gt;&lt;p&gt;‘feature_map_size’：180*180&lt;/p&gt;&lt;p&gt;for i，data in enumerate（dataloader）：一次性导入num_work个batch&lt;/p&gt;&lt;p&gt;Sparse Convolution成功用于3D目标检测的网络，相比于3D Convolution，在运算速度和显存消耗中有巨大的优势。&lt;/p&gt;&lt;p&gt;python前r表示禁止转义&lt;/p&gt;&lt;p&gt;backbone中对于feature进行卷积，体素数减少，最后dense生成密集要求size的vector&lt;/p&gt;&lt;p&gt;使用token对应相关的图片，主要看create_date时对数据集做的处理，每个数据有对应的lidar_path和info[“sweeps”]包含9个另外的雷达数据文件，邻近的&lt;/p&gt;&lt;p&gt;data中point是10个lidar文件中的点拼接在一起，第一个文件读入的为最大的时间戳&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./data/nuScenes/samples/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706547894.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706497583.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706447789.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706397490.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706347725.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706297399.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706247624.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706197302.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706147531.pcd.bin
./data/nuScenes/sweeps/LIDAR_TOP/n015-2018-10-08-15-44-23+0800__LIDAR_TOP__1538984706097778.pcd.bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;第一个文件为samples中的lidar文件，后面取9个sweeps中文件，这是中间过程中收集的数据（sensor data for intermediate frames），即第一个lidar文件融合了后面9个文件的信息，预测对应第一个文件的信息，之后跟踪中使用samples下的图片文件，和对应token的lidar文件预测结果经行跟踪&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;前十次跟踪输出：
输出的含义
last_time_stamp time_lag
detect到的物体数

1533201470.448696 0.0
236
1533201470.448696 0.49932193756103516
151
1533201470.9480178 0.49931812286376953
149
1533201471.447336 0.4998810291290283
139
1533201471.947217 0.5009839534759521
161
1533201472.448201 0.4506669044494629
172
1533201472.8988678 0.5004310607910156
211
1533201473.399299 0.5004289150238037
208
1533201473.8997278 0.5501871109008789
205
1533201474.449915 0.4993429183959961
176
1533201474.9492579 0.5004210472106934
142
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sample中为key_frame， A keyframe is a frame where the time-stamps of data from all the sensors should be very close to the time-stamp of the sample it points to.&lt;/p&gt;&lt;p&gt;最终output的构成['box3d_lidar']：shape（物体数，9），['scores']：（物体数），['label_preds']：（物体数）&lt;/p&gt;&lt;p&gt;修改只使用部分数据集&lt;/p&gt;&lt;p&gt;代码修改&lt;/p&gt;&lt;p&gt;文件：==mmdetection3d/tools/data_converter/nuscenes_converter.py==&lt;/p&gt;&lt;p&gt;函数：==_fill_trainval_infos==&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#update for part1_dataset     &lt;/span&gt;
&lt;span class="c1"&gt;# for sample in mmcv.track_iter_progress(nusc.sample):     for sample in mmcv.track_iter_progress(nusc.sample[0:3376]):&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;数据处理&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 官方 &lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;create_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;nuscenes&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nuscenes&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nb"&gt;dir&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nuscenes&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;extra&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="n"&gt;nuscenes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;至此，数据处理部分完成&lt;/p&gt;&lt;p&gt;（三）训练评价&lt;/p&gt;&lt;p&gt;这里以CenterPoint举例【单GPU】&lt;/p&gt;&lt;p&gt;训练&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;train&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;configs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint_02pillar_second_secfpn_4x8_cyclic_20e_nus&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;评价&lt;/p&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;out: 存储预测结果  -&lt;/li&gt;
&lt;li&gt;eval: 调用nuscenes官方评价方法NuScenesEval，因此仅包含Part1部分数据集，会导致报错。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;configs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint_02pillar_second_secfpn_4x8_cyclic_20e_nus&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;work_dir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;epoch_10&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pth&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nb"&gt;eval&lt;/span&gt; &lt;span class="n"&gt;bbox&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;eval_results&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;centerpoint&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pkl&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;报错分析&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/home/ch511/anaconda3/envs/open-mmlab/lib/python3.7/site-packages/nuscenes/eval/detection/evaluate.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;87&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;     
&lt;span class="s2"&gt;&amp;quot;Samples in split doesn&amp;#39;t match samples in predictions.&amp;quot;&lt;/span&gt; &lt;span class="ne"&gt;AssertionError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Samples&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt; &lt;span class="n"&gt;doesn&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t match samples in predictions.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;报错代码：&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# evaluate.py &lt;/span&gt;
&lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pred_boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample_tokens&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gt_boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample_tokens&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; \             &lt;span class="s2"&gt;&amp;quot;Samples in split doesn&amp;#39;t match samples in predictions.&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;报错原因：&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;self.pred_boxes.sample_tokens = 914，self.gt_boxes.sample_tokens = 6019&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;真实值包括整个数据集，但我仅使用了part1数据集.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;代码修改：&lt;/p&gt;&lt;p&gt;文件：/home/ch511/anaconda3/envs/open-mmlab/lib/python3.7/site-packages/nuscenes/eval/common/loaders.py&lt;/p&gt;&lt;p&gt;函数：load_gt  sample_tokens_all = [s['token'] for s in nusc.sample[0:3376]]&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;修改源码并非一个好办法，最好是self.nusc仅包括part1部分，这样加载数据时也会更快一些。【待更新】&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;（四）其他说明&lt;/p&gt;&lt;p&gt;nusc = NuScenes(version=self.version, dataroot=self.data_root, verbose=False)&lt;/p&gt;&lt;p&gt;上述操作较为耗费时间，因此我把它存储为outputs/nusc/data_false_verbose.pkl文件。每次使用时读取即可。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;tools/single_inference.py is just for single lidar frame inference, got one frame data. output the detection results.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;tools/multi_sweep_inference.py is for multi_sweep lidar data concat to inference.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;notice that it will use ego vehicle odometry infos, because it concat the multi-frame lidar into one frame, just like the training process doing, it will get better performance if the DL model are trained on multi-sweeps (e.g. Nuscesnes dataset devekit usually using 10sweeps concate on training)&lt;/p&gt;&lt;p&gt;nuScenes lidar is 32 lanes and Waymo is 64 lanes. As nuScenes produces really sparse pointcloud, we use more frames to aggregate data. For Waymo, we can also do 5 or ten but it is slower.&lt;/p&gt;&lt;ol&gt;
&lt;li&gt;Waymo has larger scene (150x150 vs. 100 x 100meter).&lt;/li&gt;
&lt;li&gt;The Waymo model's output stride is 1 compared to 4 in nuScenes. (Waymo with output stride 4 doesn't perform well)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;centerpoint+pointpainted将图片信息融合到点云中&lt;/p&gt;&lt;p&gt;选择nsweep=1可以只使用samples中的图片&lt;/p&gt;&lt;p&gt;只使用trainval01的数据集时容易因为token找不到无法寻找数据（不建议修改json文件）&lt;/p&gt;&lt;p&gt;==输出掩码mask和稀疏卷积后的特征，取两帧数据进行costvolum==&lt;/p&gt;&lt;p&gt;仔细看生成体素的过程，为什么是不一样的点数&lt;/p&gt;&lt;p&gt;==voxel_num = _points_to_voxel_reverse_kernel()==这个就是最后的体素数&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;failed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;failed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ndim&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coors_range&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;voxel_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# 判断是否在规定的coor内&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;grid_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                &lt;span class="n"&gt;failed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;
            &lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ndim_minus_1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="c1"&gt;# xyz倒过来了&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;
        &lt;span class="n"&gt;voxelidx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coor_to_voxelidx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="c1"&gt;# 一开始是-1&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;voxelidx&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# 说明没有点&lt;/span&gt;
            &lt;span class="n"&gt;voxelidx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;voxel_num&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;voxel_num&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="n"&gt;max_voxels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt; 
            &lt;span class="n"&gt;voxel_num&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="n"&gt;coor_to_voxelidx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coor&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;voxelidx&lt;/span&gt; &lt;span class="c1"&gt;# 更改，说明取了点&lt;/span&gt;
            &lt;span class="n"&gt;coors&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;voxelidx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coor&lt;/span&gt;
        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num_points_per_voxel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;voxelidx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# 一开始是0说明这个voxel取了几个点&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;max_points&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;voxels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;voxelidx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# voxelidx取的第几个点是point[i]&lt;/span&gt;
            &lt;span class="n"&gt;num_points_per_voxel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;voxelidx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;voxel_num&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;速度的生成过程：&lt;/p&gt;&lt;figure style="flex: 73.21041214750542" &gt;&lt;img width="675" height="461" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/c814239e273c11c204cea06dee050bba.png" /&gt;&lt;/figure&gt;</content><link href="/Blog/archives/3Dtracking/" rel="alternate"/><published>2021-09-17T00:00:00+08:06</published></entry><entry><id>/Blog/archives/tmux/</id><title>TMUX</title><updated>2021-10-02T13:49:57.461735+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;Tmux 是一个终端复用器（terminal multiplexer），非常有用，属于常用的开发工具。&lt;/p&gt;&lt;p&gt;本文介绍如何使用 Tmux。&lt;/p&gt;&lt;figure style="flex: 189.5734597156398" &gt;&lt;img width="800" height="211" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/972e868f94a5b045caa03b39b3afc524.png" /&gt;&lt;/figure&gt;&lt;h2&gt;一、Tmux 是什么？&lt;/h2&gt;
&lt;h3&gt;1.1 会话与进程&lt;/h3&gt;
&lt;p&gt;命令行的典型使用方式是，打开一个终端窗口（terminal window，以下简称&amp;quot;窗口&amp;quot;），在里面输入命令。&lt;strong&gt;用户与计算机的这种临时的交互，称为一次&amp;quot;会话&amp;quot;（session）&lt;/strong&gt; 。&lt;/p&gt;&lt;p&gt;会话的一个重要特点是，窗口与其中启动的进程是&lt;a href="https://www.ruanyifeng.com/blog/2016/02/linux-daemon.html"&gt;连在一起&lt;/a&gt;的。打开窗口，会话开始；关闭窗口，会话结束，会话内部的进程也会随之终止，不管有没有运行完。&lt;/p&gt;&lt;p&gt;一个典型的例子就是，&lt;a href="https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html"&gt;SSH 登录&lt;/a&gt;远程计算机，打开一个远程窗口执行命令。这时，网络突然断线，再次登录的时候，是找不回上一次执行的命令的。因为上一次 SSH 会话已经终止了，里面的进程也随之消失了。&lt;/p&gt;&lt;p&gt;为了解决这个问题，会话与窗口可以&amp;quot;解绑&amp;quot;：窗口关闭时，会话并不终止，而是继续运行，等到以后需要的时候，再让会话&amp;quot;绑定&amp;quot;其他窗口。&lt;/p&gt;&lt;h3&gt;1.2 Tmux 的作用&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Tmux 就是会话与窗口的&amp;quot;解绑&amp;quot;工具，将它们彻底分离。&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;（1）它允许在单个窗口中，同时访问多个会话。这对于同时运行多个命令行程序很有用。&lt;/p&gt;&lt;p&gt;（2） 它可以让新窗口&amp;quot;接入&amp;quot;已经存在的会话。&lt;/p&gt;&lt;p&gt;（3）它允许每个会话有多个连接窗口，因此可以多人实时共享会话。&lt;/p&gt;&lt;p&gt;（4）它还支持窗口任意的垂直和水平拆分。&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;类似的终端复用器还有 GNU Screen。Tmux 与它功能相似，但是更易用，也更强大。&lt;/p&gt;&lt;h2&gt;二、基本用法&lt;/h2&gt;
&lt;h3&gt;2.1 安装&lt;/h3&gt;
&lt;p&gt;Tmux 一般需要自己安装。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Ubuntu 或 Debian&lt;/span&gt;
$ sudo apt-get install tmux

&lt;span class="c1"&gt;# CentOS 或 Fedora&lt;/span&gt;
$ sudo yum install tmux

&lt;span class="c1"&gt;# Mac&lt;/span&gt;
$ brew install tmux
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;2.2 启动与退出&lt;/h3&gt;
&lt;p&gt;安装完成后，键入&lt;code&gt;tmux&lt;/code&gt;命令，就进入了 Tmux 窗口。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;上面命令会启动 Tmux 窗口，底部有一个状态栏。状态栏的左侧是窗口信息（编号和名称），右侧是系统信息。&lt;/p&gt;&lt;figure style="flex: 73.54709418837675" &gt;&lt;img width="734" height="499" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/f0e37423c3e6dca5e272d768d23b039d.png" /&gt;&lt;/figure&gt;&lt;p&gt;按下&lt;code&gt;Ctrl+d&lt;/code&gt;或者显式输入&lt;code&gt;exit&lt;/code&gt;命令，就可以退出 Tmux 窗口。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;2.3 前缀键&lt;/h3&gt;
&lt;p&gt;Tmux 窗口有大量的快捷键。所有快捷键都要通过前缀键唤起。默认的前缀键是&lt;code&gt;Ctrl+b&lt;/code&gt;，即先按下&lt;code&gt;Ctrl+b&lt;/code&gt;，快捷键才会生效。&lt;/p&gt;&lt;p&gt;举例来说，帮助命令的快捷键是&lt;code&gt;Ctrl+b ?&lt;/code&gt;。它的用法是，在 Tmux 窗口中，先按下&lt;code&gt;Ctrl+b&lt;/code&gt;，再按下&lt;code&gt;?&lt;/code&gt;，就会显示帮助信息。&lt;/p&gt;&lt;p&gt;然后，按下 ESC 键或&lt;code&gt;q&lt;/code&gt;键，就可以退出帮助。&lt;/p&gt;&lt;h2&gt;三、会话管理&lt;/h2&gt;
&lt;h3&gt;3.1 新建会话&lt;/h3&gt;
&lt;p&gt;第一个启动的 Tmux 窗口，编号是&lt;code&gt;0&lt;/code&gt;，第二个窗口的编号是&lt;code&gt;1&lt;/code&gt;，以此类推。这些窗口对应的会话，就是 0 号会话、1 号会话。&lt;/p&gt;&lt;p&gt;使用编号区分会话，不太直观，更好的方法是为会话起名。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux new -s &amp;lt;session-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;上面命令新建一个指定名称的会话。&lt;/p&gt;&lt;h3&gt;3.2 分离会话&lt;/h3&gt;
&lt;p&gt;在 Tmux 窗口中，按下&lt;code&gt;Ctrl+b d&lt;/code&gt;或者输入&lt;code&gt;tmux detach&lt;/code&gt;命令，就会将当前会话与窗口分离。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux detach
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;上面命令执行后，就会退出当前 Tmux 窗口，但是会话和里面的进程仍然在后台运行。&lt;/p&gt;&lt;p&gt;&lt;code&gt;tmux ls&lt;/code&gt;命令可以查看当前所有的 Tmux 会话。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux ls
&lt;span class="c1"&gt;# or&lt;/span&gt;
$ tmux list-session
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;3.3 接入会话&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux attach&lt;/code&gt;命令用于重新接入某个已存在的会话。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 使用会话编号&lt;/span&gt;
$ tmux attach -t &lt;span class="m"&gt;0&lt;/span&gt;

&lt;span class="c1"&gt;# 使用会话名称&lt;/span&gt;
$ tmux attach -t &amp;lt;session-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;3.4 杀死会话&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux kill-session&lt;/code&gt;命令用于杀死某个会话。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 使用会话编号&lt;/span&gt;
$ tmux kill-session -t &lt;span class="m"&gt;0&lt;/span&gt;

&lt;span class="c1"&gt;# 使用会话名称&lt;/span&gt;
$ tmux kill-session -t &amp;lt;session-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;3.5 切换会话&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux switch&lt;/code&gt;命令用于切换会话。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 使用会话编号&lt;/span&gt;
$ tmux switch -t &lt;span class="m"&gt;0&lt;/span&gt;

&lt;span class="c1"&gt;# 使用会话名称&lt;/span&gt;
$ tmux switch -t &amp;lt;session-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;3.6 重命名会话&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux rename-session&lt;/code&gt;命令用于重命名会话。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux rename-session -t &lt;span class="m"&gt;0&lt;/span&gt; &amp;lt;new-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;上面命令将0号会话重命名。&lt;/p&gt;&lt;h3&gt;3.7 会话快捷键&lt;/h3&gt;
&lt;p&gt;下面是一些会话相关的快捷键。&lt;/p&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b d&lt;/code&gt;：分离当前会话。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b s&lt;/code&gt;：列出所有会话。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b $&lt;/code&gt;：重命名当前会话。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2&gt;四、最简操作流程&lt;/h2&gt;
&lt;p&gt;综上所述，以下是 Tmux 的最简操作流程。&lt;/p&gt;&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;新建会话&lt;code&gt;tmux new -s my_session&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;在 Tmux 窗口运行所需的程序。&lt;/li&gt;
&lt;li&gt;按下快捷键&lt;code&gt;Ctrl+b d&lt;/code&gt;将会话分离。&lt;/li&gt;
&lt;li&gt;下次使用时，重新连接到会话&lt;code&gt;tmux attach-session -t my_session&lt;/code&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2&gt;五、窗格操作&lt;/h2&gt;
&lt;p&gt;Tmux 可以将窗口分成多个窗格（pane），每个窗格运行不同的命令。以下命令都是在 Tmux 窗口中执行。&lt;/p&gt;&lt;h3&gt;5.1 划分窗格&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux split-window&lt;/code&gt;命令用来划分窗格。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 划分上下两个窗格&lt;/span&gt;
$ tmux split-window

&lt;span class="c1"&gt;# 划分左右两个窗格&lt;/span&gt;
$ tmux split-window -h
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;figure style="flex: 80.74245939675174" &gt;&lt;img width="696" height="431" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/96766a56a4f500583b4be7b348b93fbb.jpg" /&gt;&lt;/figure&gt;&lt;h3&gt;5.2 移动光标&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux select-pane&lt;/code&gt;命令用来移动光标位置。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 光标切换到上方窗格&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-pane -U

&lt;span class="c1"&gt;# 光标切换到下方窗格&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-pane -D

&lt;span class="c1"&gt;# 光标切换到左边窗格&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-pane -L

&lt;span class="c1"&gt;# 光标切换到右边窗格&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-pane -R
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;5.3 交换窗格位置&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux swap-pane&lt;/code&gt;命令用来交换窗格位置。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 当前窗格上移&lt;/span&gt;
$ tmux swap-pane -U

&lt;span class="c1"&gt;# 当前窗格下移&lt;/span&gt;
$ tmux swap-pane -D
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;5.4 窗格快捷键&lt;/h3&gt;
&lt;p&gt;下面是一些窗格操作的快捷键。&lt;/p&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b %&lt;/code&gt;：划分左右两个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b &amp;quot;&lt;/code&gt;：划分上下两个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b &amp;lt;arrow key&amp;gt;&lt;/code&gt;：光标切换到其他窗格。&lt;code&gt;&amp;lt;arrow key&amp;gt;&lt;/code&gt;是指向要切换到的窗格的方向键，比如切换到下方窗格，就按方向键&lt;code&gt;↓&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b ;&lt;/code&gt;：光标切换到上一个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b o&lt;/code&gt;：光标切换到下一个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b {&lt;/code&gt;：当前窗格与上一个窗格交换位置。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b }&lt;/code&gt;：当前窗格与下一个窗格交换位置。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b Ctrl+o&lt;/code&gt;：所有窗格向前移动一个位置，第一个窗格变成最后一个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b Alt+o&lt;/code&gt;：所有窗格向后移动一个位置，最后一个窗格变成第一个窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b x&lt;/code&gt;：关闭当前窗格。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b !&lt;/code&gt;：将当前窗格拆分为一个独立窗口。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b z&lt;/code&gt;：当前窗格全屏显示，再使用一次会变回原来大小。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b Ctrl+&amp;lt;arrow key&amp;gt;&lt;/code&gt;：按箭头方向调整窗格大小。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b q&lt;/code&gt;：显示窗格编号。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2&gt;六、窗口管理&lt;/h2&gt;
&lt;p&gt;除了将一个窗口划分成多个窗格，Tmux 也允许新建多个窗口。&lt;/p&gt;&lt;h3&gt;6.1 新建窗口&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux new-window&lt;/code&gt;命令用来创建新窗口。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux new-window

&lt;span class="c1"&gt;# 新建一个指定名称的窗口&lt;/span&gt;
$ tmux new-window -n &amp;lt;window-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;6.2 切换窗口&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux select-window&lt;/code&gt;命令用来切换窗口。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 切换到指定编号的窗口&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-window -t &amp;lt;window-number&amp;gt;

&lt;span class="c1"&gt;# 切换到指定名称的窗口&lt;/span&gt;
$ tmux &lt;span class="k"&gt;select&lt;/span&gt;-window -t &amp;lt;window-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;6.3 重命名窗口&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tmux rename-window&lt;/code&gt;命令用于为当前窗口起名（或重命名）。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tmux rename-window &amp;lt;new-name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h3&gt;6.4 窗口快捷键&lt;/h3&gt;
&lt;p&gt;下面是一些窗口操作的快捷键。&lt;/p&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b c&lt;/code&gt;：创建一个新窗口，状态栏会显示多个窗口的信息。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b p&lt;/code&gt;：切换到上一个窗口（按照状态栏上的顺序）。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b n&lt;/code&gt;：切换到下一个窗口。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b &amp;lt;number&amp;gt;&lt;/code&gt;：切换到指定编号的窗口，其中的&lt;code&gt;&amp;lt;number&amp;gt;&lt;/code&gt;是状态栏上的窗口编号。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b w&lt;/code&gt;：从列表中选择窗口。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Ctrl+b ,&lt;/code&gt;：窗口重命名。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2&gt;七、其他命令&lt;/h2&gt;
&lt;p&gt;下面是一些其他命令。&lt;/p&gt;&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 列出所有快捷键，及其对应的 Tmux 命令&lt;/span&gt;
$ tmux list-keys

&lt;span class="c1"&gt;# 列出所有 Tmux 命令及其参数&lt;/span&gt;
$ tmux list-commands

&lt;span class="c1"&gt;# 列出当前所有 Tmux 会话的信息&lt;/span&gt;
$ tmux info

&lt;span class="c1"&gt;# 重新加载当前的 Tmux 配置&lt;/span&gt;
$ tmux source-file ~/.tmux.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;h2&gt;八、参考链接&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.hamvocke.com/blog/a-quick-and-easy-guide-to-tmux/"&gt;A Quick and Easy Guide to tmux&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://danielmiessler.com/study/tmux/"&gt;Tactical tmux: The 10 Most Important Commands&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://linuxize.com/post/getting-started-with-tmux/"&gt;Getting started with Tmux&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content><link href="/Blog/archives/tmux/" rel="alternate"/><published>2021-09-25T00:00:00+08:06</published></entry><entry><id>/Blog/archives/%E5%90%8E%E5%8F%B0/</id><title>后台和传输任务</title><updated>2021-10-02T13:49:57.461697+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;后台任务&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;只要在命令的尾部加上符号&lt;code&gt;&amp;amp;&lt;/code&gt;，启动的进程就会成为&amp;quot;后台任务&amp;quot;&lt;/p&gt;&lt;p&gt;如果要让正在运行的&amp;quot;前台任务&amp;quot;变为&amp;quot;后台任务&amp;quot;，可以先按&lt;code&gt;ctrl + z&lt;/code&gt;，然后执行&lt;code&gt;bg&lt;/code&gt;命令（让最近一个暂停的&amp;quot;后台任务&amp;quot;继续执行）&lt;/p&gt;&lt;p&gt;&lt;strong&gt;SFTP&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;sftp user@ip&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  你要用sftp, 当然得登录到sftp服务器啊， 在linux的shell中执行上面的命令后， linux shell会提示用户输入密码， 我们就输入password吧。 这样就成功建立了sftp连接。

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;p&gt;help&lt;/p&gt;&lt;p&gt;建立连接后， linux shell中的$编程了sftp&amp;gt;,  这也对。 现在执行以下help, 可以看看sftp支持哪些命令。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pwd和lpwd&lt;/p&gt;&lt;p&gt;pwd是看远端服务器的目录， 即sftp服务器默认的当前目录。  lpwd是看linux本地目录。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ls和lls&lt;/p&gt;&lt;p&gt;ls是看sftp服务器下当前目录下的东东， lls是看linux当前目录下的东东。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;put a.txt&lt;/p&gt;&lt;p&gt;这个是把linux当前目录下的a.txt文件上传到sftp服务器的当前目录下。&lt;/p&gt;&lt;figure style="flex: 271.9879518072289" &gt;&lt;img width="903" height="166" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/88742f8dc50eee3c01a6aef703bbd2d6.png" /&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;get b.txt&lt;/p&gt;&lt;p&gt;这个是把sftp服务器当前目录下的b.txt文件下载到linux当前目录下。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure style="flex: 277.1341463414634" &gt;&lt;img width="909" height="164" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/c5a88fd48ee4b823d9ae36dc72969a49.png" /&gt;&lt;/figure&gt;&lt;ol start="7"&gt;
&lt;li&gt;&lt;p&gt;!command&lt;/p&gt;&lt;p&gt;这个是指在linux上执行command这个命令， 比如!ls是列举linux当前目录下的东东， !rm a.txt是删除linux当前目录下的a.txt文件。&lt;/p&gt;&lt;p&gt;这个命令非常非常有用， 因为在sftp&amp;gt; 后输入命令， 默认值针对sftp服务器的， 所以执行rm a.txt删除的是sftp服务器上的a.txt文件， 而非本地的linux上的a.txt文件。&lt;/p&gt;&lt;ol start="8"&gt;
&lt;li&gt;&lt;p&gt;exit和quit&lt;/p&gt;&lt;p&gt;退出。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content><link href="/Blog/archives/%E5%90%8E%E5%8F%B0/" rel="alternate"/><published>2021-09-25T00:00:00+08:06</published></entry><entry><id>/Blog/archives/%E7%94%B5%E7%B1%BB%E9%87%8D%E7%82%B9%E8%A1%8C%E4%B8%9A%E4%B8%93%E5%9C%BA%E6%8B%9B%E8%81%98%E4%BC%9A/</id><title>电类重点行业专场招聘会</title><updated>2021-10-02T13:49:57.461650+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;重点行业专场招聘会&lt;/strong&gt;&lt;/p&gt;&lt;figure style="flex: 109.96563573883161" &gt;&lt;img width="1920" height="873" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/b23a218246009b9e64eed46b779b0ac2.png" /&gt;&lt;/figure&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;中国科学院沈阳自动化研究所&lt;/p&gt;&lt;p&gt;想了解的研究所的生活：分团队，分项目，分各种各样的方向。一种是基础的理论研究（&lt;strong&gt;发论文&lt;/strong&gt;），另外一个方向是国家重点工程项目（&lt;strong&gt;会有实地的项目测试&lt;/strong&gt;）&lt;/p&gt;&lt;p&gt;读研在国科大读半年学，读博的在中科大读一年，之后参与项目，项目时间相对和职工一样，有对应的节假日，论文要求发表数量比高校少，日常生活补贴多（国家+研究所+导师）博士能够有5、6千每个月&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;广州海格通信集团股份有限公司&lt;/p&gt;&lt;p&gt;算法岗硕士起招，其他岗位本科（知乎风评不好），主要岗位多在广州，压抑性的体验&lt;/p&gt;&lt;figure style="flex: 37.5" &gt;&lt;img width="3000" height="4000" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/6ca08501a33481588d82b20e2b4556b8.png" /&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;浪潮集团&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;AI岗的话还是要自己多积累项目经验，建议考研之后再就业
问的问题更专业一点，CNN，RNN，DNN（从来没有接触过）。有的公司使用的是tensorflow，问你卷积层常使用多大3&lt;em&gt;3还是什么的，基础知识还是要多了解研究，关注代码技术和经验（&lt;/em&gt;&lt;em&gt;对于letcode和计算机体系结构要求基础&lt;/em&gt;*）&lt;/p&gt;&lt;p&gt;先去大厂实习，京东和字节&lt;/p&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;上海航天八院808研究所&lt;/p&gt;&lt;p&gt;工作和高校类似，但压力会更大一点，时间节点压力大。晋升公平，看你的贡献程度。上面就看你的机遇和国家体制的固化限制&lt;/p&gt;&lt;p&gt;能否参与项目看你以前的研究背景，通过了就可以前往参与研究&lt;/p&gt;&lt;p&gt;研究生起招。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</content><link href="/Blog/archives/%E7%94%B5%E7%B1%BB%E9%87%8D%E7%82%B9%E8%A1%8C%E4%B8%9A%E4%B8%93%E5%9C%BA%E6%8B%9B%E8%81%98%E4%BC%9A/" rel="alternate"/><published>2021-09-28T00:00:00+08:06</published></entry><entry><id>/Blog/archives/%E8%B6%85%E7%AE%97%E5%B9%B3%E5%8F%B0/</id><title>超算平台使用</title><updated>2021-10-02T13:49:57.461606+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;超算平台&lt;/strong&gt;&lt;/p&gt;&lt;figure style="flex: 35.45688545688546" &gt;&lt;img width="551" height="777" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/0c38935ddf710089cd795b7042de8e9d.png" /&gt;&lt;/figure&gt;&lt;p&gt;记得注释掉#JSUB后的注释&lt;/p&gt;&lt;p&gt;source activate要在base环境下执行&lt;/p&gt;&lt;h1&gt;测试 分配 GPU&lt;/h1&gt;
&lt;h3&gt;测试脚本如下， 使用 torch.device('cuda+str(gpu_index)') 即可&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;torch&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;num_gpu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cuda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;device_count&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_gpu&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cuda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_device_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cur_gpu: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cuda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_device_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="n"&gt;gpu_index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;

    &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cuda:&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gpu_index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cuda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_available&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;torch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;终端运行脚本&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/sh
#JSUB -J gpu
#JSUB -n 4
##JSUB -q normal
#JSUB -m h3cgpu01
#JSUB -o out.%J
#JSUB -e err.%J
source /public/jhinno/unischeduler/job_starter/unisched

module load miniconda3
sleep 1
source activate
conda activate wxr_cu111
cd ~/lsq/test_cuda
python test_cuda.py &amp;gt;&amp;gt; ./output.log
###############################

sleep 100
nvidia-smi &amp;gt;&amp;gt; nvidia.log

&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;输出结果&lt;/h3&gt;
&lt;p&gt;cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cur_gpu:  NVIDIA A100-PCIE-40GB
cuda:2
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:2')&lt;/p&gt;</content><link href="/Blog/archives/%E8%B6%85%E7%AE%97%E5%B9%B3%E5%8F%B0/" rel="alternate"/><published>2021-10-01T00:00:00+08:06</published></entry><entry><id>/Blog/archives/%E7%AE%97%E5%AD%90%E7%BC%96%E8%AF%91/</id><title>算子编译</title><updated>2021-10-02T13:49:57.461515+00:00</updated><author><name>刘胜琪</name><email>1959376918@qq.com</email><uri>https://lsqsjtu.github.io/Blog/</uri></author><content>&lt;p&gt;&lt;strong&gt;算子编译&lt;/strong&gt;&lt;/p&gt;&lt;figure style="flex: 158.61423220973782" &gt;&lt;img width="847" height="267" src="https://cdn.jsdelivr.net/gh/LSQsjtu/Blog@gh-pages/archives/assets/8a8da5282cc8e2f6eb39c83bf48c7a52.png" /&gt;&lt;/figure&gt;&lt;p&gt;高低版本的问题&lt;/p&gt;</content><link href="/Blog/archives/%E7%AE%97%E5%AD%90%E7%BC%96%E8%AF%91/" rel="alternate"/><published>2021-10-02T00:00:00+08:06</published></entry></feed>